new_data$African.American[new_data$African.American %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$African.American <- as.numeric(new_data$African.American)
new_data$Asian.American[new_data$Asian.American %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$Asian.American <- as.numeric(new_data$Asian.American)
new_data$Latino[new_data$Latino %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$Latino <- as.numeric(new_data$Latino)
new_data$Native.American[new_data$Native.American %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$Native.American <- as.numeric(new_data$Native.American)
#le_by_state source
#http://ghdx.healthdata.org/record/united-states-adult-life-expectancy-state-and-county-1987-2009#
#le_by_income_state
#https://healthinequality.org/data/ table 5#
server <- function(input, output) {
source("data_wrangling.R")
source("data_processing.R")
# Server stuff
output$plot1a <- renderPlot({
plot1a <- ggplot(data = income_by_le) +
geom_point(mapping = aes(x = Avg.Life.Expectancy.Years, y = median_income,  color = Race)) +
labs(title = "Relationship Between Average Life Expectancy and Median Income",
x = "Average Life Expectancy",
y = "Median Income")
plot1a
})
output$plot1b <- renderPlot({
plot1b <- ggplot(data = income_by_le) +
geom_point(mapping = aes(x = Year, y = median_income,  color = Race)) +
labs(title = "Median Income Over Tiime",
x = "Year",
y = "Median Income")
plot1b
})
output$plot1c <- renderPlot({
plot1c <- ggplot(data = income_by_le) +
geom_point(mapping = aes(x = Year, y = Avg.Life.Expectancy.Years,  color = Race)) +
labs(title = "Average Life Expectancy Over Tiime",
x = "Year",
y = "Average Life Expectancy")
plot1c
})
output$plot2white <- renderPlotly({
plot2white <- ggplot(data = new_data) +
geom_polygon(aes(x = long, y = lat, group = group,
fill = cut(new_data$White, seq(65, 90, by = 2), include.lowest = TRUE))) +
scale_fill_manual(values = c("#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#0c2c84"), na.value = "#636363")
plot2white + geom_point()
ggplotly(plot2white, tooltip="region")
})
output$plot2afa <- renderPlotly({
plot2afa <- ggplot(data = new_data) +
geom_polygon(aes(x = long, y = lat, group = group,
fill = cut(new_data$African.American, seq(65, 90, by = 2), include.lowest = TRUE))) +
scale_fill_manual(values = c("#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#0c2c84"), na.value = "#636363")
plot2afa + geom_point()
ggplotly(plot2afa, tooltip="region")
})
output$plot2asa <- renderPlotly({
plot2asa <- ggplot(data = new_data) +
geom_polygon(aes(x = long, y = lat, group = group,
fill = cut(new_data$Asian.American, seq(65, 90, by = 2), include.lowest = TRUE))) +
scale_fill_manual(values = c("#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#0c2c84"), na.value = "#636363")
plot2asa + geom_point()
ggplotly(plot2asa, tooltip="region")
})
output$plot2na <- renderPlotly({
plot2na <- ggplot(data = new_data) +
geom_polygon(aes(x = long, y = lat, group = group, fill =
cut(new_data$Native.American, seq(65, 90, by = 2), include.lowest = TRUE))) +
scale_fill_manual(values = c("#c7e9b4", "#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#0c2c84"), na.value = "#636363")
plot2na + geom_point()
ggplotly(plot2na, tooltip="region")
})
output$plot2lat <- renderPlotly({
plot2lat <- ggplot(data = new_data) +
geom_polygon(aes(x = long, y = lat, group = group, fill =
cut(new_data$Latino, seq(65, 90, by = 2), include.lowest = TRUE))) +
scale_fill_manual(values = c("#c7e9b4", "#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#0c2c84"), na.value = "#636363")
plot2lat + geom_point()
ggplotly(plot2lat, tooltip="region")
})
# Question 3 Plots - Sebastian
output$plot3a <- renderPlot({
plot3a <- ggplot(data = pct_women_poor_health) +
geom_point(mapping = aes(x = Location, y = All.Women,
size = All.Women, color = Location)) +
labs(title = "Percent of Adult Women Reporting Fair or Poor Health Status by Race/Ethnicity",
x = "Location (State/Territory)",
y = "Percentage of Women Reporting Fair/Poor Health Status") +
theme(axis.text.x = element_blank())
plot3a
})
output$plot3b <- renderPlot({
plot3b <- ggplot(data = pct_men_poor_health) +
geom_point(mapping = aes(x = Location, y = All.Men,
size = All.Men, color = Location)) +
labs(title = "Percent of Adult Men Reporting Fair or Poor Health Status by Race/Ethnicity",
x = "Location (State/Territory)",
y = "Percentage of Men Reporting Fair/Poor Health Status") +
theme(axis.text.x = element_blank())
plot3b
})
output$plot3cw <- renderPlotly({
plot3cw <- ggplot(data = state_dist_uninsured_by_race) +
geom_polygon(aes(x = long, y = lat, group = group, fill =
cut(state_dist_uninsured_by_race$White, seq(0.1, 0.9, by = 0.2), include.lowest = TRUE))) +
scale_fill_manual(values = c("#c7e9b4", "#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#0c2c84"), na.value = "#636363")
plot3cw + geom_point()
ggplotly(plot3cw, tooltip="region")
plot3cw
})
output$plot3cb <- renderPlotly({
plot3cb <- ggplot(data = state_dist_uninsured_by_race) +
geom_polygon(aes(x = long, y = lat, group = group, fill =
cut(state_dist_uninsured_by_race$Black, seq(0.1, 0.9, by = 0.2), include.lowest = TRUE))) +
scale_fill_manual(values = c("#c7e9b4", "#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#0c2c84"), na.value = "#636363")
plot3cb + geom_point()
ggplotly(plot3cb, tooltip="region")
plot3cb
})
output$plot3ch <- renderPlotly({
plot3ch <- ggplot(data = state_dist_uninsured_by_race) +
geom_polygon(aes(x = long, y = lat, group = group, fill =
cut(state_dist_uninsured_by_race$Hispanic, seq(0.1, 0.9, by = 0.2), include.lowest = TRUE))) +
scale_fill_manual(values = c("#c7e9b4", "#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#0c2c84"), na.value = "#636363")
plot3ch + geom_point()
ggplotly(plot3ch, tooltip="region")
plot3ch
})
}
income_by_race <- read_xlsx("data/income_by_race.xlsx")
le_national <- read_xlsx("data/life_expectancy_death_rates.xlsx")
pct_insurance_by_race <- read_xlsx("data/pct_insurance_by_race.xlsx")
le_by_state <- read.csv("data/IHME_US_STATE_LIFE_EXPECTANCY_1987_2009.csv", stringsAsFactors = FALSE)
le_by_income_state <- read.csv("data/health_ineq_online_table_5.csv", stringsAsFactors = FALSE)
le_at_birth_race <- read.csv("data/le_at_birth_race.csv", stringsAsFactors = FALSE)
income_by_race <- as.data.frame(income_by_race)
le_national <- as.data.frame(le_national)
pct_insurance_by_race <- as.data.frame(pct_insurance_by_race)
# Combine income and le dataframes, get income_by_le
income_black_white <- income_by_race %>%
filter(Race %in% c("All Races", "White Alone", "Black Alone")) %>%
select(Year, Race, median)
le_black_white <- le_national %>%
filter(Sex == "Both Sexes") %>%
select(-Age.Adusted.Death.Rate)
income_black_white_wide_median <- spread(income_black_white,
key = "Race",
value = "median" )
colnames(income_black_white_wide_median) <- c("Year", "All Races", "Black", "White")
income_black_white <- gather(income_black_white_wide_median,
key = "Race",
value = "median_income", "All Races", "Black", "White")
income_by_le <- left_join(income_black_white, le_black_white, by = c("Year", "Race"))
income_by_le
#find life expectancy per state for African Americans
le_at_birth_race <- le_at_birth_race %>%
mutate(Location = tolower(Location))
le_at_birth_race <- rename(le_at_birth_race, region = Location)
state_data <- map_data('state')
new_data <- left_join(state_data, le_at_birth_race)
new_data$African.American[new_data$African.American %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$African.American <- as.numeric(new_data$African.American)
new_data$Asian.American[new_data$Asian.American %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$Asian.American <- as.numeric(new_data$Asian.American)
new_data$Latino[new_data$Latino %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$Latino <- as.numeric(new_data$Latino)
new_data$Native.American[new_data$Native.American %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$Native.American <- as.numeric(new_data$Native.American)
#le_by_state source
#http://ghdx.healthdata.org/record/united-states-adult-life-expectancy-state-and-county-1987-2009#
#le_by_income_state
#https://healthinequality.org/data/ table 5#
income_by_race <- read_xlsx("data/income_by_race.xlsx")
le_national <- read_xlsx("data/life_expectancy_death_rates.xlsx")
pct_insurance_by_race <- read_xlsx("data/pct_insurance_by_race.xlsx")
le_by_state <- read.csv("data/IHME_US_STATE_LIFE_EXPECTANCY_1987_2009.csv", stringsAsFactors = FALSE)
le_by_income_state <- read.csv("data/health_ineq_online_table_5.csv", stringsAsFactors = FALSE)
le_at_birth_race <- read.csv("data/le_at_birth_race.csv", stringsAsFactors = FALSE)
income_by_race <- as.data.frame(income_by_race)
le_national <- as.data.frame(le_national)
pct_insurance_by_race <- as.data.frame(pct_insurance_by_race)
# Combine income and le dataframes, get income_by_le
income_black_white <- income_by_race %>%
filter(Race %in% c("All Races", "White Alone", "Black Alone")) %>%
select(Year, Race, median)
le_black_white <- le_national %>%
filter(Sex == "Both Sexes") %>%
select(-Age.Adusted.Death.Rate)
income_black_white_wide_median <- spread(income_black_white,
key = "Race",
value = "median" )
colnames(income_black_white_wide_median) <- c("Year", "All Races", "Black", "White")
income_black_white <- gather(income_black_white_wide_median,
key = "Race",
value = "median_income", "All Races", "Black", "White")
income_by_le <- left_join(income_black_white, le_black_white, by = c("Year", "Race"))
income_by_le
#find life expectancy per state for African Americans
le_at_birth_race <- le_at_birth_race %>%
mutate(Location = tolower(Location))
le_at_birth_race <- rename(le_at_birth_race, region = Location)
state_data <- map_data('state')
new_data <- left_join(state_data, le_at_birth_race)
new_data$African.American[new_data$African.American %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$African.American <- as.numeric(new_data$African.American)
new_data$Asian.American[new_data$Asian.American %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$Asian.American <- as.numeric(new_data$Asian.American)
new_data$Latino[new_data$Latino %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$Latino <- as.numeric(new_data$Latino)
new_data$Native.American[new_data$Native.American %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$Native.American <- as.numeric(new_data$Native.American)
#le_by_state source
#http://ghdx.healthdata.org/record/united-states-adult-life-expectancy-state-and-county-1987-2009#
#le_by_income_state
#https://healthinequality.org/data/ table 5#
income_by_race <- read_xlsx("data/income_by_race.xlsx")
le_national <- read_xlsx("data/life_expectancy_death_rates.xlsx")
pct_insurance_by_race <- read_xlsx("data/pct_insurance_by_race.xlsx")
le_by_state <- read.csv("data/IHME_US_STATE_LIFE_EXPECTANCY_1987_2009.csv", stringsAsFactors = FALSE)
le_by_income_state <- read.csv("data/health_ineq_online_table_5.csv", stringsAsFactors = FALSE)
le_at_birth_race <- read.csv("data/le_at_birth_race.csv", stringsAsFactors = FALSE)
income_by_race <- as.data.frame(income_by_race)
le_national <- as.data.frame(le_national)
pct_insurance_by_race <- as.data.frame(pct_insurance_by_race)
# Combine income and le dataframes, get income_by_le
income_black_white <- income_by_race %>%
filter(Race %in% c("All Races", "White Alone", "Black Alone")) %>%
select(Year, Race, median)
le_black_white <- le_national %>%
filter(Sex == "Both Sexes") %>%
select(-Age.Adusted.Death.Rate)
income_black_white_wide_median <- spread(income_black_white,
key = "Race",
value = "median" )
colnames(income_black_white_wide_median) <- c("Year", "All Races", "Black", "White")
income_black_white <- gather(income_black_white_wide_median,
key = "Race",
value = "median_income", "All Races", "Black", "White")
income_by_le <- left_join(income_black_white, le_black_white, by = c("Year", "Race"))
income_by_le
#find life expectancy per state for African Americans
le_at_birth_race <- le_at_birth_race %>%
mutate(Location = tolower(Location))
le_at_birth_race <- rename(le_at_birth_race, region = Location)
state_data <- map_data('state')
new_data <- left_join(state_data, le_at_birth_race)
new_data$African.American[new_data$African.American %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$African.American <- as.numeric(new_data$African.American)
new_data$Asian.American[new_data$Asian.American %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$Asian.American <- as.numeric(new_data$Asian.American)
new_data$Latino[new_data$Latino %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$Latino <- as.numeric(new_data$Latino)
new_data$Native.American[new_data$Native.American %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$Native.American <- as.numeric(new_data$Native.American)
#le_by_state source
#http://ghdx.healthdata.org/record/united-states-adult-life-expectancy-state-and-county-1987-2009#
#le_by_income_state
#https://healthinequality.org/data/ table 5#
income_by_race <- read_xlsx("data/income_by_race.xlsx")
le_national <- read_xlsx("data/life_expectancy_death_rates.xlsx")
pct_insurance_by_race <- read_xlsx("data/pct_insurance_by_race.xlsx")
le_by_state <- read.csv("data/IHME_US_STATE_LIFE_EXPECTANCY_1987_2009.csv", stringsAsFactors = FALSE)
le_by_income_state <- read.csv("data/health_ineq_online_table_5.csv", stringsAsFactors = FALSE)
le_at_birth_race <- read.csv("data/le_at_birth_race.csv", stringsAsFactors = FALSE)
income_by_race <- as.data.frame(income_by_race)
le_national <- as.data.frame(le_national)
pct_insurance_by_race <- as.data.frame(pct_insurance_by_race)
# Combine income and le dataframes, get income_by_le
income_black_white <- income_by_race %>%
filter(Race %in% c("All Races", "White Alone", "Black Alone")) %>%
select(Year, Race, median)
le_black_white <- le_national %>%
filter(Sex == "Both Sexes") %>%
select(-Age.Adusted.Death.Rate)
income_black_white_wide_median <- spread(income_black_white,
key = "Race",
value = "median" )
colnames(income_black_white_wide_median) <- c("Year", "All Races", "Black", "White")
income_black_white <- gather(income_black_white_wide_median,
key = "Race",
value = "median_income", "All Races", "Black", "White")
income_by_le <- left_join(income_black_white, le_black_white, by = c("Year", "Race"))
income_by_le
#find life expectancy per state for African Americans
le_at_birth_race <- le_at_birth_race %>%
mutate(Location = tolower(Location))
le_at_birth_race <- rename(le_at_birth_race, region = Location)
state_data <- map_data('state')
new_data <- left_join(state_data, le_at_birth_race)
new_data$African.American[new_data$African.American %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$African.American <- as.numeric(new_data$African.American)
new_data$Asian.American[new_data$Asian.American %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$Asian.American <- as.numeric(new_data$Asian.American)
new_data$Latino[new_data$Latino %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$Latino <- as.numeric(new_data$Latino)
new_data$Native.American[new_data$Native.American %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$Native.American <- as.numeric(new_data$Native.American)
#le_by_state source
#http://ghdx.healthdata.org/record/united-states-adult-life-expectancy-state-and-county-1987-2009#
#le_by_income_state
#https://healthinequality.org/data/ table 5#
income_by_race <- read_xlsx("data/income_by_race.xlsx")
le_national <- read_xlsx("data/life_expectancy_death_rates.xlsx")
pct_insurance_by_race <- read_xlsx("data/pct_insurance_by_race.xlsx")
le_by_state <- read.csv("data/IHME_US_STATE_LIFE_EXPECTANCY_1987_2009.csv", stringsAsFactors = FALSE)
le_by_income_state <- read.csv("data/health_ineq_online_table_5.csv", stringsAsFactors = FALSE)
le_at_birth_race <- read.csv("data/le_at_birth_race.csv", stringsAsFactors = FALSE)
income_by_race <- as.data.frame(income_by_race)
le_national <- as.data.frame(le_national)
pct_insurance_by_race <- as.data.frame(pct_insurance_by_race)
# Combine income and le dataframes, get income_by_le
income_black_white <- income_by_race %>%
filter(Race %in% c("All Races", "White Alone", "Black Alone")) %>%
select(Year, Race, median)
le_black_white <- le_national %>%
filter(Sex == "Both Sexes") %>%
select(-Age.Adusted.Death.Rate)
income_black_white_wide_median <- spread(income_black_white,
key = "Race",
value = "median" )
colnames(income_black_white_wide_median) <- c("Year", "All Races", "Black", "White")
income_black_white <- gather(income_black_white_wide_median,
key = "Race",
value = "median_income", "All Races", "Black", "White")
income_by_le <- left_join(income_black_white, le_black_white, by = c("Year", "Race"))
income_by_le
#find life expectancy per state for African Americans
le_at_birth_race <- le_at_birth_race %>%
mutate(Location = tolower(Location))
le_at_birth_race <- rename(le_at_birth_race, region = Location)
state_data <- map_data('state')
new_data <- left_join(state_data, le_at_birth_race)
new_data$African.American[new_data$African.American %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$African.American <- as.numeric(new_data$African.American)
new_data$Asian.American[new_data$Asian.American %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$Asian.American <- as.numeric(new_data$Asian.American)
new_data$Latino[new_data$Latino %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$Latino <- as.numeric(new_data$Latino)
new_data$Native.American[new_data$Native.American %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$Native.American <- as.numeric(new_data$Native.American)
#le_by_state source
#http://ghdx.healthdata.org/record/united-states-adult-life-expectancy-state-and-county-1987-2009#
#le_by_income_state
#https://healthinequality.org/data/ table 5#
income_by_race <- read_xlsx("data/income_by_race.xlsx")
le_national <- read_xlsx("data/life_expectancy_death_rates.xlsx")
pct_insurance_by_race <- read_xlsx("data/pct_insurance_by_race.xlsx")
le_by_state <- read.csv("data/IHME_US_STATE_LIFE_EXPECTANCY_1987_2009.csv", stringsAsFactors = FALSE)
le_by_income_state <- read.csv("data/health_ineq_online_table_5.csv", stringsAsFactors = FALSE)
le_at_birth_race <- read.csv("data/le_at_birth_race.csv", stringsAsFactors = FALSE)
income_by_race <- as.data.frame(income_by_race)
le_national <- as.data.frame(le_national)
pct_insurance_by_race <- as.data.frame(pct_insurance_by_race)
# Combine income and le dataframes, get income_by_le
income_black_white <- income_by_race %>%
filter(Race %in% c("All Races", "White Alone", "Black Alone")) %>%
select(Year, Race, median)
le_black_white <- le_national %>%
filter(Sex == "Both Sexes") %>%
select(-Age.Adusted.Death.Rate)
income_black_white_wide_median <- spread(income_black_white,
key = "Race",
value = "median" )
colnames(income_black_white_wide_median) <- c("Year", "All Races", "Black", "White")
income_black_white <- gather(income_black_white_wide_median,
key = "Race",
value = "median_income", "All Races", "Black", "White")
income_by_le <- left_join(income_black_white, le_black_white, by = c("Year", "Race"))
income_by_le
#find life expectancy per state for African Americans
le_at_birth_race <- le_at_birth_race %>%
mutate(Location = tolower(Location))
le_at_birth_race <- rename(le_at_birth_race, region = Location)
state_data <- map_data('state')
new_data <- left_join(state_data, le_at_birth_race)
new_data$African.American[new_data$African.American %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$African.American <- as.numeric(new_data$African.American)
new_data$Asian.American[new_data$Asian.American %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$Asian.American <- as.numeric(new_data$Asian.American)
new_data$Latino[new_data$Latino %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$Latino <- as.numeric(new_data$Latino)
new_data$Native.American[new_data$Native.American %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$Native.American <- as.numeric(new_data$Native.American)
#le_by_state source
#http://ghdx.healthdata.org/record/united-states-adult-life-expectancy-state-and-county-1987-2009#
#le_by_income_state
#https://healthinequality.org/data/ table 5#
income_by_race <- read_xlsx("data/income_by_race.xlsx")
le_national <- read_xlsx("data/life_expectancy_death_rates.xlsx")
pct_insurance_by_race <- read_xlsx("data/pct_insurance_by_race.xlsx")
le_by_state <- read.csv("data/IHME_US_STATE_LIFE_EXPECTANCY_1987_2009.csv", stringsAsFactors = FALSE)
le_by_income_state <- read.csv("data/health_ineq_online_table_5.csv", stringsAsFactors = FALSE)
le_at_birth_race <- read.csv("data/le_at_birth_race.csv", stringsAsFactors = FALSE)
income_by_race <- as.data.frame(income_by_race)
le_national <- as.data.frame(le_national)
pct_insurance_by_race <- as.data.frame(pct_insurance_by_race)
# Combine income and le dataframes, get income_by_le
income_black_white <- income_by_race %>%
filter(Race %in% c("All Races", "White Alone", "Black Alone")) %>%
select(Year, Race, median)
le_black_white <- le_national %>%
filter(Sex == "Both Sexes") %>%
select(-Age.Adusted.Death.Rate)
income_black_white_wide_median <- spread(income_black_white,
key = "Race",
value = "median" )
colnames(income_black_white_wide_median) <- c("Year", "All Races", "Black", "White")
income_black_white <- gather(income_black_white_wide_median,
key = "Race",
value = "median_income", "All Races", "Black", "White")
income_by_le <- left_join(income_black_white, le_black_white, by = c("Year", "Race"))
income_by_le
#find life expectancy per state for African Americans
le_at_birth_race <- le_at_birth_race %>%
mutate(Location = tolower(Location))
le_at_birth_race <- rename(le_at_birth_race, region = Location)
state_data <- map_data('state')
new_data <- left_join(state_data, le_at_birth_race)
new_data$African.American[new_data$African.American %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$African.American <- as.numeric(new_data$African.American)
new_data$Asian.American[new_data$Asian.American %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$Asian.American <- as.numeric(new_data$Asian.American)
new_data$Latino[new_data$Latino %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$Latino <- as.numeric(new_data$Latino)
new_data$Native.American[new_data$Native.American %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$Native.American <- as.numeric(new_data$Native.American)
#le_by_state source
#http://ghdx.healthdata.org/record/united-states-adult-life-expectancy-state-and-county-1987-2009#
#le_by_income_state
#https://healthinequality.org/data/ table 5#
income_by_race <- read_xlsx("data/income_by_race.xlsx")
le_national <- read_xlsx("data/life_expectancy_death_rates.xlsx")
pct_insurance_by_race <- read_xlsx("data/pct_insurance_by_race.xlsx")
le_by_state <- read.csv("data/IHME_US_STATE_LIFE_EXPECTANCY_1987_2009.csv", stringsAsFactors = FALSE)
le_by_income_state <- read.csv("data/health_ineq_online_table_5.csv", stringsAsFactors = FALSE)
le_at_birth_race <- read.csv("data/le_at_birth_race.csv", stringsAsFactors = FALSE)
income_by_race <- as.data.frame(income_by_race)
le_national <- as.data.frame(le_national)
pct_insurance_by_race <- as.data.frame(pct_insurance_by_race)
# Combine income and le dataframes, get income_by_le
income_black_white <- income_by_race %>%
filter(Race %in% c("All Races", "White Alone", "Black Alone")) %>%
select(Year, Race, median)
le_black_white <- le_national %>%
filter(Sex == "Both Sexes") %>%
select(-Age.Adusted.Death.Rate)
income_black_white_wide_median <- spread(income_black_white,
key = "Race",
value = "median" )
colnames(income_black_white_wide_median) <- c("Year", "All Races", "Black", "White")
income_black_white <- gather(income_black_white_wide_median,
key = "Race",
value = "median_income", "All Races", "Black", "White")
income_by_le <- left_join(income_black_white, le_black_white, by = c("Year", "Race"))
income_by_le
#find life expectancy per state for African Americans
le_at_birth_race <- le_at_birth_race %>%
mutate(Location = tolower(Location))
le_at_birth_race <- rename(le_at_birth_race, region = Location)
state_data <- map_data('state')
new_data <- left_join(state_data, le_at_birth_race)
new_data$African.American[new_data$African.American %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$African.American <- as.numeric(new_data$African.American)
new_data$Asian.American[new_data$Asian.American %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$Asian.American <- as.numeric(new_data$Asian.American)
new_data$Latino[new_data$Latino %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$Latino <- as.numeric(new_data$Latino)
new_data$Native.American[new_data$Native.American %in% "NSD"] <- "0"
new_data[new_data == 0] <- NA
new_data$Native.American <- as.numeric(new_data$Native.American)
#le_by_state source
#http://ghdx.healthdata.org/record/united-states-adult-life-expectancy-state-and-county-1987-2009#
#le_by_income_state
#https://healthinequality.org/data/ table 5#
shiny::runApp('school/info-201/infoaa2final')
setwd("~/school/info-201/infoaa2final")
shiny::runApp()
